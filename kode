library(readxl)
library(tidyr)
library(ggplot2)
library(dplyr)
library(readr)

#Importing data on consumption and states
can_main <- read_excel("C:/Users/s13476/OneDrive - Norges Handelshøyskole/Masterveiledning/Anne/Cannabis.xlsx",sheet = 1, col_names = TRUE)
can_main <- data.frame(can_main)

legal <- read_excel("C:/Users/s13476/OneDrive - Norges Handelshøyskole/Masterveiledning/Anne/Cannabis.xlsx",sheet = 2, col_names = TRUE)
legal <- data.frame(legal)
legal$leg_year <- as.integer(legal$leg_year)

#removing entries with NA from legal, to create a list of all states where cannabis is legal
only_legal <- legal[complete.cases(legal$leg_year),]

#creating a dummy for states that have legalized
can_main$legal_dummy <- 0

for(i in 1:nrow(main_ro)){
  for(j in 1:nrow(enforcement_ro_collapsed)){ 
    if(main_ro$buyer_city[i] %in% treated_cities){ 
            main_ro$treated_dummy[i] <- "1" 
    } else {
            main_ro$treated_dummy[i] <- "0" 
            }
  }
  print(i)
}

#graphical summary
ggplot(can_main, aes(x= year, y= use, group = state, color= state))+
  geom_line()+
  geom_point()

